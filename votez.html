<head>
	<title>votez</title>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places"></script>
 	<script type="text/javascript">
 	var map;
    var infowindow;
    function initialize() {
        var pyrmont = new google.maps.LatLng(-33.8665433, 151.1956316);

        map = new google.maps.Map(document.getElementById('map-canvas'), {
            center: pyrmont,
            zoom: 15
        });

        var request = {
            location: pyrmont,
            radius: 500,
            types: ['store']
        };
        infowindow = new google.maps.InfoWindow();
        var service = new google.maps.places.PlacesService(map);
        service.nearbySearch(request, callback);
    };

    function callback(results, status) {
        if (status == google.maps.places.PlacesServiceStatus.OK) {
            for (var i = 0; i < results.length; i++) {
                createMarker(results[i]);
            }
        }
    };

function createMarker(place) {
  var placeLoc = place.geometry.location;
  var marker = new google.maps.Marker({
    map: map,
    position: place.geometry.location
  });

  google.maps.event.addListener(marker, 'click', function() {
    infowindow.setContent(place.name);
    infowindow.open(map, this);
  });
};

google.maps.event.addDomListener(window, 'load', initialize);
 	</script>
 	<style>
      html, body, #map-canvas {
        height: 400px;
        margin: 0px;
        padding: 0px
      }
    </style>
</head>

<body>
	<div class="container">
        <div class="row">&nbsp;</div>
		<div class="row">
			<div class="col-lg-5 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-9">
                <div class="row">
                    <div class="panel panel-default">
                        <div class="panel-heading">Locations Map</div>
                        <div class="panel-body" id="map-canvas"></div>
                    </div>
                </div>
                <div class="row">
    				{{> newPlace}}
                </div>
                <div class="row">
                    {{> header}}
                    {{> placesList}}
                </div>
			</div>
		</div>
		<!-- <div class="row">
			<div class="col-md-4 col-md-offset-4">
				{{> header}}
				{{> placesList}}
			</div>
		</div> -->
	</div>
</body>

<template name="header">
	<h2>Cast your vote&nbsp;<button type="button" class="btn btn-sm reset">Reset</button></h2>
</template>

<template name="placesList">
	<ul class="list-group">
	{{#each places}}
		{{> placeInfo}}
	{{/each}}
	</ul>
</template>

<template name="placeInfo">
	<li class="list-group-item">
		<button type="button" class="btn btn-primary btn-xs pull-right vote">Vote</button>
        <span class="pull-right">&nbsp;&nbsp;&nbsp;</span>
		<span class="badge">{{votes}}</span>
	    {{name}}
	</li>
</template>

<template name="newPlace">
	<form role="form" class="newPlaceForm">
		<div class="input-group">
			<input type="text" class="form-control" id="name" />
			<span class="input-group-btn">
				<button class="btn btn-default" type="submit">Add</button>
			</span>
		</div><!-- /input-group -->
	</form>
</template>
